#summary Tutorial Lesson: Refitting individual residues

= Tutorial Lesson: Refitting individual residues =

Scenario: You have been refining a protein structure which is correct except for the positions of a few residues which still misfit the electron density map after the last cycles of refinement. You wish to refit these amino acids. The lesson illustrates methods for refitting individual amino acids.

  # Copy files automation_misfit.pdb and automation_out.mtz from the examples directory of your MIFit installation into a new directory. These files are a coordinate file that contains a few model-fitting errors and file of phased x-ray data in mtz format from a refinement with CCP4/REFMAC5.
  # Select the *MIFit File/Open models, data, maps, etc…* command to load file automation_misfit.pdb and automation_out.mtz from the directory established in (1). (Ctrl+click to select both files.)
  # A dialog will appear to allow selection of MTZ columns labels. In this example we will create the electron density map from pre-computed likelihood-weighted structure factor coefficients and phases that were calculated by the REFMAC5 program. i.e. we will not use the true values for Fobs and phase but will simplify the calculation route by utilizing pre-computed map coefficients. Since MIFit automatically recognizes MTZ files with standard REFMAC5 column labels, the dialog will automatically be set to load these values. Simply click on OK.
  # Scroll down to residue X 142 in the *Residues List* section of the *Models* view and double click on it. This action will re-center the model and map on the Cα atom in residue X 142 Tyr. You will notice that the side chain of this amino acid does not fit the density.
  # Select the residue to be fit (X 142 Tyr) by clicking on any atom in it in the main canvas. Now select either the *Fit/Fit Residue* command or the http://mifit.googlecode.com/svn/wiki/fit-residue_icon.png icon in the toolbar or the keyboard shortcut *F*. The residue should turn green to indicate that it is active for fitting.
  # Try translating the residue by either clicking on the *Fit/Translate* command or the http://mifit.googlecode.com/svn/wiki/fit-translate_icon.png icon in the toolbar. Using the right mouse button you can now move the selected residue around the canvas.
  # Try rotating the residue by either clicking on the *Fit/Rotate* command or the http://mifit.googlecode.com/svn/wiki/fit-rotate_icon.png rotate icon in the toolbar. Using the right mouse button you can now rotate the selected residue around the canvas.
  # Reset the position of the amino acid back to the starting position but leaving it in fitting mode by selecting the *Fit/Reset Fit* command.
  # To activate rotation of the side chain about the χ1 angle (i.e. along the bond between the Cα and Cß atoms) enter *1* on the keyboard.  You should see a grey arrow that points from the Cα to the Cß atom appear on the model in the main canvas window. Use the right mouse button to rotate the side chain about χ1 into the electron density. 
  # The side chain also needs to be adjusted about the χ2 angle (i.e. the bond between the Cß and Cγ atoms). Enter *2* on the keyboard and you should see the grey arrow shift to point from Cß to Cγ. Use the right mouse button to rotate the side chain about χ2 into the density.
  # In a real fitting session you would have accepted this fit either by selecting the *Fit/Accept Fit* command, by clicking on the http://mifit.googlecode.com/svn/wiki/fit-accept_icon.png icon on the toolbar or by using the keyboard shortcut *;*. Here, select *Fit/Reset Fit* so that the lesson can continue to show other fitting methods. Select the http://mifit.googlecode.com/svn/wiki/fit-cancel_icon.png cancel fit icon to deactivate this residue.
  # A convenient way to refit side chains is to use the *Model/Replace and fit* command (or the keyboard shortcut *R*). To try this click on any atom in X 142 Tyr in the main canvas. After selecting the replace-and-fit command a dialog box will popup containing a menu with all possible entity types. Since we want to retain the default amino acid type (Tyr) select OK. You will see that the Tyr side chain move to fit the electron density. To save this fit you could select the http://mifit.googlecode.com/svn/wiki/fit-accept_icon.png icon from the toolbar. Alternatively, to cancel this fit click, select the http://mifit.googlecode.com/svn/wiki/fit-cancel_icon.png icon from the toolbar.
  # We will now correct a common type of main chain fitting error, a ‘peptide flip’, in which the carbonyl oxygen is rotated approximately 180 degrees from the correct orientation. Make sure that Chain:X in the navigation tree is still selected (icon is colored blue) and scroll the Residues: list to residue X 37 and double click on it. This action will re-center the model and map on the Cα atom in X 37 Phe. You will notice that the main chain of this amino acid does not fit the density.
  # Click on the carbonyl (O atom) in X 37 Phe. Select *Fit/Fix Backbone/Flip Peptide*. You will see the peptide plane flip over so that the carbonyl now properly fits the electron density.
  # You will now use a pentamer library to check a part of the protein structure. Make sure that Chain:X in the navigation tree is still selected (icon is colored blue), scroll down to residue X 192 and double click on it. This action will re-center the model and map on the Cα atom in Glu X 192 Glu. 
  # Click on any atom in X 192 Glu in the main view. Select *Fit/Fix Backbone/Suggest Backbone Match*. You will see a pentamer match to the backbone, starting at X 192 Glu, appear on the screen. In this case the protein conformation is similar to the pentamer and there is no reason to change it. If the atomic model dims you may turn of the dimming by unchecking the Render/Dim Non-active models command. The image of the pentamer match can be removed with the *Fit/Fix Backbone/Clear Backbone Match* command. In cases where the backbone should be refit to match the pentamer the four *Fit/Fix Backbone/Replace* commands could be used to replace parts of the structure.
  # You may select *File/Close* or *File/Exit* to close this session or shut down MIFit.
